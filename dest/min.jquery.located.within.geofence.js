if(!google.maps.Polygon.prototype.getBounds){google.maps.Polygon.prototype.getBounds=function(latLng){var bounds=new google.maps.LatLngBounds,paths=this.getPaths(),path,p,i;for(p=0;p<paths.getLength();p++){path=paths.getAt(p);for(i=0;i<path.getLength();i++){bounds.extend(path.getAt(i))}}return bounds}}google.maps.Polygon.prototype.containsLatLng=function(latLng){var inPoly=false,bounds,lat,lng,numPaths,p,path,numPoints,i,j,vertex1,vertex2;if(arguments.length==2){if(typeof arguments[0]=="number"&&typeof arguments[1]=="number"){lat=arguments[0];lng=arguments[1]}}else if(arguments.length==1){bounds=this.getBounds();if(!bounds&&!bounds.contains(latLng)){return false}lat=latLng.lat();lng=latLng.lng()}else{console.log("Wrong number of inputs in google.maps.Polygon.prototype.contains.LatLng")}numPaths=this.getPaths().getLength();for(p=0;p<numPaths;p++){path=this.getPaths().getAt(p);numPoints=path.getLength();j=numPoints-1;for(i=0;i<numPoints;i++){vertex1=path.getAt(i);vertex2=path.getAt(j);if(vertex1.lng()<lng&&vertex2.lng()>=lng||vertex2.lng()<lng&&vertex1.lng()>=lng){if(vertex1.lat()+(lng-vertex1.lng())/(vertex2.lng()-vertex1.lng())*(vertex2.lat()-vertex1.lat())<lat){inPoly=!inPoly}}j=i}}return inPoly};(function($,window,undefined){var pluginName="locatedWithinGeofence",document=window.document,defaults={address:"",geofence:[],apikey:""};function LocatedWithinGeofence(options){this.options=$.extend({},defaults,options);this._defaults=defaults;this._name=pluginName;this.init();return this}LocatedWithinGeofence.prototype.init=function(){if(this.options.geofence.length){this.setGeofence()}if(this.options.address.length){this.setAddress()}};LocatedWithinGeofence.prototype.setGeofence=function(coords){var self=this;this.rawFenceCoords=coords!==undefined?coords:this.options.geofence;this.realFenceCoords=[];$.each(this.rawFenceCoords,function(index,coords){self.realFenceCoords.push(new google.maps.LatLng(coords[0],coords[1]))});this.geofence=new google.maps.Polygon({paths:this.realFenceCoords,strokeColor:"#FF0000",strokeOpacity:.8,strokeWeight:2,fillColor:"#FF0000",fillOpacity:.35})};LocatedWithinGeofence.prototype.setAddress=function(address){var self=this;this.address=address!==undefined?address:this.options.address;var params={address:this.address};if(this.options.apikey.length){params.key=this.options.apikey}this.$addressLoaded=$.ajax({url:"https://maps.googleapis.com/maps/api/geocode/json",type:"GET",dataType:"json",data:params,success:function(data){self.addressCoord=[data.results[0].geometry.location.lat,data.results[0].geometry.location.lng]}});return this.$addressLoaded};LocatedWithinGeofence.prototype.isWithin=function(callback){var self=this;this.$addressLoaded.done(function(){var isWithin=self.geofence.containsLatLng(self.addressCoord[0],self.addressCoord[1]);callback.call(self,isWithin)})};$.extend({locatedWithinGeofence:function(options){return new LocatedWithinGeofence(options)}})})(jQuery,window);